(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{6532:function(e,t,a){Promise.resolve().then(a.bind(a,2912))},2912:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var s=a(7437),l=a(2265),n=a(446),r=a(9116);function i(){let{user:e,token:t,updateUser:a}=(0,n.a)(),[i,o]=(0,l.useState)({name:"",email:"",phone:""}),[u,c]=(0,l.useState)(null),[d,m]=(0,l.useState)(null),[p,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{e&&(o({name:e.name||"",email:e.email||"",phone:e.phone||""}),e.avatar&&m(e.avatar))},[e]);let f=async e=>{e.preventDefault(),h(!0);try{let e=new FormData;e.append("name",i.name),e.append("email",i.email),u&&e.append("profile_image",u);let t=(await r.Z.post("/auth/profile/update",e,{headers:{"Content-Type":"multipart/form-data"}})).data;a({name:t.user.name,email:t.user.email,avatar:t.user.avatar}),alert("Profile updated successfully")}catch(e){var t,s;console.error(e),alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Something went wrong")}finally{h(!1)}};if(!e)return null;let x=e.name?e.name.split(" ").map(e=>e[0]).join("").toUpperCase():"U";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Edit Profile"}),(0,s.jsxs)("div",{className:"flex items-center gap-6 mb-6",children:[(0,s.jsxs)("div",{className:"relative",children:[d?(0,s.jsx)("img",{src:d,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border"}):(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 text-2xl font-semibold",children:x}),(0,s.jsxs)("label",{className:"absolute bottom-0 right-0 bg-indigo-600 text-white text-xs px-2 py-1 rounded cursor-pointer",children:["Change",(0,s.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{let t=e.target.files[0];t&&(c(t),m(URL.createObjectURL(t)))}})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-lg",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Upload a profile picture"})]})]}),(0,s.jsxs)("form",{onSubmit:f,className:"max-w-md space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-gray-600",children:"Full Name"}),(0,s.jsx)("input",{type:"text",className:"w-full h-11 border rounded-lg px-3 mt-1",value:i.name,onChange:e=>o({...i,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-gray-600",children:"Email Address"}),(0,s.jsx)("input",{type:"email",className:"w-full h-11 border rounded-lg px-3 mt-1",value:i.email,onChange:e=>o({...i,email:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-gray-600",children:"Mobile Number"}),(0,s.jsx)("input",{type:"tel",className:"w-full h-11 border rounded-lg px-3 mt-1 cursor-not-allowed",value:i.phone,disabled:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"h-11 px-6 bg-indigo-600 text-white rounded-lg text-sm disabled:opacity-60",children:p?"Saving...":"Save Changes"})]})]})}},446:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return r},a:function(){return i}});var s=a(7437),l=a(2265);let n=(0,l.createContext)(void 0);function r(e){let{children:t}=e,[a,r]=(0,l.useState)(null),[i,o]=(0,l.useState)(null),[u,c]=(0,l.useState)(!0),[d,m]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=localStorage.getItem("jb-fashions-user"),t=localStorage.getItem("jb-fashions-token");e&&t&&(r(JSON.parse(e)),o(t)),c(!1)},[]),(0,l.useEffect)(()=>{a&&i?(localStorage.setItem("jb-fashions-user",JSON.stringify(a)),localStorage.setItem("jb-fashions-token",i)):(localStorage.removeItem("jb-fashions-user"),localStorage.removeItem("jb-fashions-token"))},[a,i]),(0,s.jsx)(n.Provider,{value:{user:a,token:i,isAuthenticated:!!i,loading:u,login:(e,t)=>{o(e),r(t),m(!1)},logout:()=>{r(null),o(null),localStorage.removeItem("cartSynced")},updateUser:e=>{r(t=>t?{...t,...e}:t)},loginOpen:d,openLogin:()=>m(!0),closeLogin:()=>m(!1)},children:!u&&t})}function i(){let e=(0,l.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,a){"use strict";let s=a(3464).Z.create({baseURL:"https://herbal-api.easybizcart.com/api",headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});s.interceptors.request.use(e=>{{let t=localStorage.getItem("jb-fashions-token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t,a;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.warn("401 error detected from:",null===(a=e.config)||void 0===a?void 0:a.url),Promise.reject(e)}),t.Z=s}},function(e){e.O(0,[464,971,117,744],function(){return e(e.s=6532)}),_N_E=e.O()}]);